<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Documentation — Virtual Color Mixing Lab</title>
  <style>
    :root{--bg1:#f8faf9;--bg2:#f1f5f4;--ink:#0f172a;--muted:#475569;--card:#ffffff;--line:#e2e8f0;--accent:#10b981;--accent2:#059669;--shadow:0 25px 60px rgba(0,0,0,.08);--r:20px;--r-sm:12px}
    *{box-sizing:border-box}
    body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial,sans-serif;color:var(--ink);
      background:radial-gradient(900px 600px at 15% 10%, rgba(16,185,129,.08), transparent 55%),
                 radial-gradient(900px 600px at 90% 15%, rgba(5,150,105,.06), transparent 55%),
                 linear-gradient(160deg,var(--bg1),var(--bg2));
      min-height:100vh;padding:32px}
    .shell{max-width:1100px;margin:0 auto;background:var(--card);border:1px solid var(--line);border-radius:calc(var(--r) + 8px);
      box-shadow:var(--shadow);overflow:hidden}
    header{padding:28px 30px;border-bottom:1px solid var(--line);
      background:linear-gradient(135deg, rgba(16,185,129,.06), rgba(5,150,105,.04)),
                 linear-gradient(0deg, rgba(255,255,255,.85), rgba(255,255,255,.85))}
    h1{margin:0;font-size:28px;font-weight:850;letter-spacing:-.02em}
    .sub{margin-top:8px;color:var(--muted);font-size:14px;line-height:1.6}
    .body{padding:26px 30px}
    .nav{display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap}
    a{color:var(--accent2);text-decoration:none;font-weight:650;border-bottom:1px solid rgba(5,150,105,.35)}
    a:hover{border-bottom-color:rgba(5,150,105,.7)}
    h2{margin:22px 0 10px;font-size:18px}
    p{margin:8px 0;color:var(--muted);line-height:1.7}
    code, pre{font-family:ui-monospace,Menlo,Consolas,monospace}
    pre{margin:12px 0;padding:14px 16px;border-radius:14px;border:1px solid var(--line);background:linear-gradient(180deg,#0b1220,#0a0f1a);color:#e5e7eb;overflow:auto}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:16px}
    @media (max-width:900px){.grid{grid-template-columns:1fr}}
    .card{border:1px solid var(--line);border-radius:var(--r);background:rgba(248,250,249,.7);padding:16px 18px}
    .small{font-size:13px}
    .k{display:inline-block;padding:2px 8px;border-radius:999px;background:rgba(16,185,129,.12);border:1px solid rgba(16,185,129,.22);color:#065f46;font-weight:800;font-size:12px}
  </style>
</head>
<body>
  <div class="shell">
    <header>
      <div class="nav">
        <div>
          <h1>Documentation</h1>
          <div class="sub">How the simulator works, how to write experiment scripts, and how to download data.</div>
        </div>
        <div><a href="index.html">Back to lab</a></div>
      </div>
    </header>

    <div class="body">
      <div class="grid">
        <div class="card">
          <div class="k">Concept</div>
          <h2>What this project is</h2>
          <p>This is a pure software simulation of a color mixing lab. You choose volumes of <code>R</code>, <code>Y</code>, and <code>B</code>, and the simulator returns an 8-channel spectral sensor reading.</p>
          <p class="small">There is no robot connection. The “well” is a location label like A1, A2, … used to model a systematic position effect.</p>
        </div>
        <div class="card">
          <div class="k">Outputs</div>
          <h2>What you see in results</h2>
          <p><strong>Mixture swatch</strong>: computed from R/Y/B volumes using a simple weighted RGB mix.</p>
          <p><strong>Sensor swatch</strong>: computed from the 8 channels using <code>colour-science</code> after sum-normalising the channel counts.</p>
        </div>
      </div>

      <h2>How to write a script</h2>
      <p>Your code must define a variable named <code>experiment_design</code>. It must be a list of dictionaries, where each dictionary is one experiment.</p>

      <pre># One experiment
experiment_design = [
    {'R': 298, 'Y': 1, 'B': 1, 'well': 'A1'}
]
print('Designed', len(experiment_design), 'experiments')
</pre>

      <pre># Multiple experiments (batch)
experiment_design = []
experiment_design.append({'R': 50, 'Y': 50, 'B': 50, 'well': 'A1'})
experiment_design.append({'R': 80, 'Y': 40, 'B': 60, 'well': 'A2'})
print('Designed', len(experiment_design), 'experiments')
</pre>

      <h2>Rules and limits</h2>
      <p>- Each volume must be between 1 and 300 µL.</p>
      <p>- Total volume must satisfy <code>R + Y + B &lt;= 300</code>.</p>
      <p>- <code>well</code> is optional. If you omit it, wells are assigned automatically.</p>

      <h2>Why wells exist</h2>
      <p>The simulator includes a systematic well-position effect (about 10%). That means the same mixture can produce slightly different readings in different wells, similar to real plate effects.</p>

      <h2>How to generate and download data</h2>
      <p>1) Start the backend server:</p>
      <pre>.\.venv\Scripts\python flask_backend.py</pre>
      <p>2) Open the lab page and click <strong>Run</strong>.</p>
      <p>3) Click <strong>Download CSV</strong> to save your session’s results.</p>

      <h2>Troubleshooting</h2>
      <p>- If the lab page shows “Network error”, confirm <code>http://127.0.0.1:5000/api/health</code> opens in your browser.</p>
      <p>- “Method Not Allowed” happens if you open <code>/api/execute_batch</code> directly; it requires POST requests from the UI.</p>

      <p class="small" style="margin-top:18px">If you want, we can add a “Single experiment mode” toggle that automatically forces <code>experiment_design</code> to contain only one entry.</p>
    </div>
  </div>
</body>
</html>
